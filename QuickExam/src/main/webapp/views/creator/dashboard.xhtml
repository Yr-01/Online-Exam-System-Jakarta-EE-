<ui:composition template="sidebar.xhtml"
                xmlns:ui="jakarta.faces.facelets"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core">

    <ui:define name="title">Creator Dashboard</ui:define>
    <ui:define name="pageTitle">My Creator Dashboard</ui:define>

    <ui:define name="content">
        <!-- Fixed Animated Background -->
        <div class="fixed inset-0 -z-10 overflow-hidden pointer-events-none">
            <div class="absolute top-0 -left-32 w-96 h-96 bg-gradient-to-br from-purple-400 to-indigo-400 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"></div>
            <div class="absolute top-40 -right-32 w-96 h-96 bg-gradient-to-br from-teal-400 to-cyan-400 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>
            <div class="absolute -bottom-32 left-1/3 w-96 h-96 bg-gradient-to-br from-pink-400 to-rose-400 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000"></div>
        </div>

        <!-- Scrollable Content Only -->
        <div class="h-full flex flex-col overflow-y-auto pb-20" style="height: calc(100vh - 80px); overflow-y: auto; padding-right: 10px;"> <!-- This is the only scrolling part -->
            <div class="p-6 ">
                <!-- Header -->
                <div class="text-center mb-12">
                    <h1 class="text-5xl font-extrabold bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 bg-clip-text text-transparent">
                        Creator Dashboard
                    </h1>
                    <p class="text-xl text-gray-600 mt-4">
                        Welcome back, <span class="font-bold text-indigo-700">#{userController.currentUser.prenom}</span>
                        <br class="hidden md:block"/>
                        <span class="text-base">Manage your exams and track your impact</span>
                    </p>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 mb-12">
                    <div class="bg-white/90 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/50 hover:shadow-3xl transition-all duration-500 hover:-translate-y-2">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-lg">Total Exams Created</p>
                                <p class="text-5xl font-bold text-indigo-700 mt-3">#{userController.totalMyExams}</p>
                            </div>
                            <div class="p-5 bg-indigo-100 rounded-2xl">
                                <i class="fas fa-file-alt text-4xl text-indigo-600"></i>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white/90 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/50 hover:shadow-3xl transition-all duration-500 hover:-translate-y-2">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-lg">Registered Candidates</p>
                                <p class="text-5xl font-bold text-teal-700 mt-3">#{userController.totalRegisteredCandidates}</p>
                            </div>
                            <div class="p-5 bg-teal-100 rounded-2xl">
                                <i class="fas fa-users text-4xl text-teal-600"></i>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white/90 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/50 hover:shadow-3xl transition-all duration-500 hover:-translate-y-2">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-lg">Passed Candidates</p>
                                <p class="text-5xl font-bold text-emerald-700 mt-3">#{userController.totalPassedCandidates}</p>
                            </div>
                            <div class="p-5 bg-emerald-100 rounded-2xl">
                                <i class="fas fa-trophy text-4xl text-emerald-600"></i>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white/90 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/50 hover:shadow-3xl transition-all duration-500 hover:-translate-y-2">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-lg">Completed Sessions</p>
                                <p class="text-5xl font-bold text-purple-700 mt-3">#{userController.totalCompletedExams}</p>
                            </div>
                            <div class="p-5 bg-purple-100 rounded-2xl">
                                <i class="fas fa-check-circle text-4xl text-purple-600"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="mb-12">
                    <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Quick Actions</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-5xl mx-auto">
                        <h:link outcome="#{examController.goToCreateExam()}"
                                styleClass="group bg-gradient-to-br from-indigo-500 to-purple-600 text-white rounded-3xl p-10 text-center hover:shadow-2xl hover:scale-105 transition-all duration-500">
                            <i class="fas fa-plus-circle text-6xl mb-6 group-hover:rotate-90 transition-transform"></i>
                            <p class="text-2xl font-bold">Create New Exam</p>
                            <p class="text-sm opacity-90 mt-2">Start building a new assessment</p>
                        </h:link>

                        <h:link outcome="#{examController.viewExamSession()}"
                                styleClass="group bg-gradient-to-br from-teal-500 to-cyan-600 text-white rounded-3xl p-10 text-center hover:shadow-2xl hover:scale-105 transition-all duration-500">
                            <i class="fas fa-chart-line text-6xl mb-6 group-hover:translate-y-[-8px] transition-transform"></i>
                            <p class="text-2xl font-bold">View Results</p>
                            <p class="text-sm opacity-90 mt-2">Analyze performance &amp; scores</p>
                        </h:link>

                        <h:link outcome="#{examController.goToMyExams()}"
                                styleClass="group bg-gradient-to-br from-pink-500 to-rose-600 text-white rounded-3xl p-10 text-center hover:shadow-2xl hover:scale-105 transition-all duration-500">
                            <i class="fas fa-list-alt text-6xl mb-6 group-hover:rotate-12 transition-transform"></i>
                            <p class="text-2xl font-bold">Manage Exams</p>
                            <p class="text-sm opacity-90 mt-2">Edit or review existing exams</p>
                        </h:link>
                    </div>
                </div>

                <!-- Recent Activity Grid -->
                <div class="grid lg:grid-cols-2 gap-10 mb-20">
                    <!-- Recent Exams -->
                    <div class="bg-white/90 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/30">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                            <i class="fas fa-clock text-indigo-600 text-3xl"></i>
                            Recent Exams
                        </h3>
                        <div class="space-y-4">
                            <ui:repeat value="#{userController.myRecentExams}" var="exam">
                                <div class="flex justify-between items-center p-5 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl hover:shadow-md transition">
                                    <div>
                                        <p class="font-semibold text-gray-900">#{exam.theme}</p>
                                        <p class="text-sm text-gray-600 mt-1">
                                            #{exam.nbrQuestion} questions • #{exam.examTime} min • Created #{exam.createdAt.toLocalDate()}
                                        </p>
                                    </div>
                                    <span class="text-sm font-medium text-indigo-700 bg-indigo-100 px-4 py-2 rounded-full">
                                        Active
                                    </span>
                                </div>
                            </ui:repeat>

                            <h:panelGroup rendered="#{empty userController.myRecentExams}">
                                <div class="text-center py-12">
                                    <i class="fas fa-inbox text-6xl text-gray-300 mb-4"></i>
                                    <p class="text-gray-500 text-lg">No exams created yet</p>
                                    <p class="text-gray-400 mt-2">Your created exams will appear here</p>
                                </div>
                            </h:panelGroup>
                        </div>
                    </div>

                    <!-- Upcoming Sessions -->
                    <div class="bg-white/90 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/30">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                            <i class="fas fa-calendar-alt text-teal-600 text-3xl"></i>
                            Upcoming Sessions
                        </h3>
                        <div class="space-y-4">
                            <ui:repeat value="#{userController.recentExamSessions}" var="sessionexam">
                                <div class="flex justify-between items-center p-5 bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl hover:shadow-md transition">
                                    <div>
                                        <p class="font-semibold text-gray-900">#{sessionexam.exam.theme}</p>
                                        <p class="text-sm text-gray-600 mt-1">
                                            #{sessionexam.candidate.prenom} #{sessionexam.candidate.nom} •
                                            #{sessionexam.date} at #{sessionexam.heureDebut}
                                        </p>
                                    </div>
                                    <span class="text-sm font-medium text-teal-700 bg-teal-100 px-4 py-2 rounded-full">
                                        Scheduled
                                    </span>
                                </div>
                            </ui:repeat>

                            <h:panelGroup rendered="#{empty userController.recentExamSessions}">
                                <div class="text-center py-12">
                                    <i class="fas fa-calendar-times text-6xl text-gray-300 mb-4"></i>
                                    <p class="text-gray-500 text-lg">No upcoming sessions</p>
                                    <p class="text-gray-400 mt-2">Scheduled exams will appear here</p>
                                </div>
                            </h:panelGroup>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Animations & Custom Scrollbar -->
        <style>
            @keyframes blob {
                0% { transform: translate(0px, 0px) scale(1); }
                33% { transform: translate(30px, -50px) scale(1.1); }
                66% { transform: translate(-20px, 20px) scale(0.9); }
                100% { transform: translate(0px, 0px) scale(1); }
            }
            .animate-blob { animation: blob 12s infinite; }
            .animation-delay-2000 { animation-delay: 2s; }
            .animation-delay-4000 { animation-delay: 4s; }

            /* Custom Scrollbar - Only for content */
            .overflow-y-auto::-webkit-scrollbar { width: 10px; }
            .overflow-y-auto::-webkit-scrollbar-track { background: transparent; }
            .overflow-y-auto::-webkit-scrollbar-thumb {
                background: linear-gradient(to bottom, #c4b5fd, #a78bfa);
                border-radius: 10px;
                border: 3px solid transparent;
            }
            .overflow-y-auto::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(to bottom, #9333ea, #a78bfa);
            }
        </style>
    </ui:define>
</ui:composition>